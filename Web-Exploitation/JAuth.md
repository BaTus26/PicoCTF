# Write-up : JAuth
---
### Description :
> Most web application developers use third party components without testing their security. Some of the past affected companies are:
> Equifax (a US credit bureau organization) - breach due to unpatched Apache Struts web framework CVE-2017-5638
> Mossack Fonesca (Panama Papers law firm) breach - unpatched version of Drupal CMS used
> VerticalScope (internet media company) - outdated version of vBulletin forum software used
> Can you identify the components and exploit the vulnerable one?
> Additional details will be available after launching your challenge instance.
### Hint :
> Use the web browser tools to check out the JWT cookie.
> The JWT should always have two (2) . separators.
---
### Solution :
- Như đề bài đã đề cập thì lỗi lần này liên quan đến CVE-2017-5638, lỗi này liên quan đến token
- Sau khi khởi động challenge thì chúng ta được cung cấp 1 tài khoản với username : `` test `` và password : `` Test123! `` 
- Sau khi đăng nhập với tài khoản đó thì ta vào phần `` application `` rồi vào phần cookie, tiếp đó chúng ta có thể xem được token của bài

Như CVE mô tả thì ta có thể thay đổi token để truy cập các tài khoản khác, việc của chúng ta bây giờ là thay đổi token để đăng nhập vào tài khoản admin.
> Để thay đổi token thì chúng ta vào trang `` https://token.dev/ `` để thay đổi token

Sau khi dán token của chúng ta vào ô `` JWT String `` thì các thông tin của header và payload của token sẽ hiện ra.
Sửa đổi giá trị của `` alg `` thành `` none `` và  `` role `` thành `` admin `` cuối cùng là thêm `` dấu chấm `` vào cuối token 
Sau đó là quay lại trang web và sửa đổi giá trị token mới vào bằng cách : 
- click chuột phải vào ô giá trị token
- chọn `` edit "value" `` và paste giá trị đã sửa đổi vào sau đó nhấn enter.
- cuối cùng là f5 để reset trang
Sau các bước thì sẽ nhận lại được flag của bài.
### Flag : `` picoCTF{succ3ss_@u7h3nt1c@710n_72bf8bd5} ``
